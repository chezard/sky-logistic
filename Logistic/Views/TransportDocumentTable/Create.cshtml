@model TransportDocumentTable
@{
    ViewData["Title"] = "Create";
    var countryList = ViewData["country"] as List<Country>;
}


<div class="row">
<div class="col-12 grid-margin stretch-card">
<div class="card">
<div class="card-body">
<h4 class="card-title">Create</h4>
<form class="forms-sample" id="document_form" method="post" enctype="multipart/form-data">
<div class="row">
<div class="col-6">
    <input type="hidden" name="transportDocumentId" value="@ViewBag.TId"/>
    @*<div class="form-group form-group-float w-lg-50">
                                <label>Dasinma Senedi</label>
                                <select class="custom-select " name="transportDocumentId">
                                    @foreach (TransportDocument transportDocument in ViewBag.TransportDocuments)
                                    {
                                        <option value="@transportDocument.Id">SL @transportDocument.Id</option>
                                    }
                                </select>
                            </div>*@
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label>Type</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/conditionofcarriage/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select class="custom-select " name="conditionOfCarriageId">
            @foreach (ConditionOfCarriage conditionOfCarriage in ViewBag.ConditionOfCarriages)
            {
                <option value="@conditionOfCarriage.Id">@conditionOfCarriage.Name</option>
            }
        </select>
    </div>
    <div class="form-group">
        <label asp-for="Date">Date</label>
        <input type="date" asp-for="Date" class="form-control" placeholder="Date">
        <span asp-validation-for="Date" class="text-danger"></span>
    </div>

    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label>Status</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/statusofshipment/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select class="custom-select " name="statusOfShipmentId">
            @foreach (StatusOfShipment statusOfShipment in ViewBag.StatusOfShipments)
            {
                <option value="@statusOfShipment.Id">@statusOfShipment.Name</option>
            }
        </select>
    </div>
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label>Incoterm</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/typeoftransportation/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select class="custom-select " name="typeOfTransportationId">
            @foreach (TypeOfTransportation typeOfTransportation in ViewBag.TypeOfTransportations)
            {
                <option value="@typeOfTransportation.Id">@typeOfTransportation.Name</option>
            }
        </select>
    </div>
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label>Direction</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/directionoftransportation/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select class="custom-select " name="directionOfTransportationId">
            @foreach (DirectionOfTransportation directionOfTransportation in ViewBag.DirectionOfTransportations)
            {
                <option value="@directionOfTransportation.Id">@directionOfTransportation.Type</option>
            }
        </select>
    </div>
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label>Customer</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/customerlegalperson/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select class="custom-select " name="customer">
            @foreach (CustomerLegalPerson customerLegalPerson in ViewBag.CustomerLegalPeople)
            {
                <option value="@customerLegalPerson.Name">@customerLegalPerson.Name </option>
            }

            @foreach (UnofficialClient unofficialClient in ViewBag.UnofficialClients)
            {
                <option value="@unofficialClient.Name">@unofficialClient.Name</option>
            }
        </select>
    </div>
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label>Partner</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/institution/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select class="custom-select " name="InstitutionId">
            @foreach (Institution institution in ViewBag.Institutions)
            {
                <option value="@institution.Id">@institution.Name</option>
            }
        </select>
    </div>
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label>From</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/country/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select name="FirstCountry" class="form-control" id="countries">
            <option value="">Seçin</option>
            @foreach (var item in countryList)
            {
                <option value=@item.Id>@item.Name</option>
            }
        </select>
    </div>
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label >City</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/city/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select name="FirstCity" class="form-control" id="cities">
            <option value="">Seçin</option>
        </select>
        <span class="text-danger"></span>
    </div>
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label>To</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/country/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select name="LastCountry" class="form-control" id="lastcountries">
            <option value="">Seçin</option>
            @foreach (var item in countryList)
            {
                <option value=@item.Id>@item.Name</option>
            }
        </select>
    </div>
    <div class="form-group form-group-float w-lg-50">
        <div class="d-flex justify-content-between">
            <label >City</label>
            <div class="mb-1">
                <a class="btn btn-sm btn-success" href="/city/create" target="_blank">+</a>
                <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
            </div>
        </div>
        <select name="LastCity" class="form-control" id="lastcities">
            <option value="">Seçin</option>
        </select>
        <span class="text-danger"></span>
        <span class="text-danger"></span>
    </div>
</div>
<div class="col-6">
    <div class="form-group form-group-float w-lg-50">
            <div class="d-flex justify-content-between">
                <label>Currency</label>
                <div class="mb-1">
                    <a class="btn btn-sm btn-success" href="/valyuta/create" target="_blank">+</a>
                    <button type="button" id="institution-list-refresh" class="btn btn-sm btn-primary">o</button>
                </div>
            </div>
            <select class="custom-select " name="valyutaId">
            @foreach (Valyuta valyuta in ViewBag.Valyutas)
            {
                <option value="@valyuta.Id">@valyuta.Name</option>
            }
        </select>
    </div>

    <div class="form-group">
    <label asp-for="DriverName">Driver</label>
    <input asp-for="DriverName" class="form-control" placeholder="DriverName">
    <span asp-validation-for="DriverName" class="text-danger"></span>
</div>

<div class="form-group">
    <label asp-for="DriverPhone">DriverPhone</label>
    <input asp-for="DriverPhone" class="form-control" placeholder="DriverPhone">
    <span asp-validation-for="DriverPhone" class="text-danger"></span>
</div>


<div class="form-group">
    <label asp-for="TruckPlate">TruckPlate</label>
    <input asp-for="TruckPlate" class="form-control" placeholder="TruckPlate">
    <span asp-validation-for="TruckPlate" class="text-danger"></span>
</div>


<div class="form-group">
    <label asp-for="Name">Description</label>
    <input asp-for="Name" class="form-control" placeholder="Name">
    <span asp-validation-for="Name" class="text-danger"></span>
</div>
<div class="form-group">
    <label asp-for="Count">Quantity</label>
    <input asp-for="Count" class="form-control" placeholder="Say">
    <span asp-validation-for="Count" class="text-danger"></span>
</div>
@* <div class="form-group"> *@
@*     <label asp-for="Salary">Sale</label> *@
@*     <input asp-for="Salary" value="0" class="form-control" placeholder="Gelir"> *@
@*     <span asp-validation-for="Salary" class="text-danger"></span> *@
@* </div> *@
@* *@
@* <div class="form-group"> *@
@*     <label asp-for="CommonSalary">Paid</label> *@
@*     <input asp-for="CommonSalary" value="0" class="form-control" placeholder="Paid"> *@
@*     <span asp-validation-for="CommonSalary" class="text-danger"></span> *@
@* </div> *@

<div class="form-group form-group-float w-lg-50">
    <label>Manager</label>
    <select class="custom-select " name="personalId">
        @foreach (Personal manager in ViewBag.Personals)
        {
            <option value="@manager.Id">@manager.Name</option>
        }
    </select>
</div>
<div class="form-group">
    <label asp-for="Description">Note</label>
    <textarea asp-for="Description" class="form-control" rows="4"></textarea>
    <span asp-validation-for="Description" class="text-danger"></span>
</div>
</div>
</div>
<button type="submit" class="btn btn-primary mr-2">Create</button>
<a asp-controller="TransportDocument" asp-action="Index" class="btn btn-secondary">Go back</a>

</form>

</div>
</div>
</div>
</div>


@section scripts {

    <script src="~/lib/select2/js/select2.full.min.js"></script>
    <script src="~/js/select2.js"></script>

    <script>



        //$("#countries").change(function () {
        //    console.log('RUNNED')
        //    $("#cities").html('')
        //    $("#cities").append(`<option value="">Loading...</option>`)
        //    let countryId = $(this).val()
        //    $.ajax({
        //        url: `/Address/FindCity?countryId=${countryId}`,
        //        type: "Get",
        //        success: function (res)
        //                    console.log(res)
        //                        var resval = res.value
        //                        $("#cities").html('')
        //                        $("#cities").append(`<option value="">Seçin</option>`)
        //                        for(var model of resval.data) {
        //        $("#cities").append(`<option value=${model.Id}>${model.Name}</option>`)
        //    }
        //}
        //                })
        //        })

        $(document).ready(function () {
            $('#countries').select2();
        });
        $(document).ready(function () {
            $('#cities').select2();
        });
        $(document).ready(function () {
            $('#lastcountries').select2();
        });
        $(document).ready(function () {
            $('#lastcities').select2();
        });

        $("#countries").change(function () {
            let countryId = $(this).val();
            console.log(countryId)
            $("#cities").html('')
            //$("#countries").html('')
            //$("#countries").append(`<option value="">Loading...</option>`)
            $.ajax({
                url: `/Address/FindCity?countryId=${countryId}`,
                type: "Get",
                success: function (res) {
                    $("#cities").html('')
                    $("#cities").append(`<option value="">Seçin</option>`)
                    for (var model of res) {
                        $("#cities").append(`<option value=${model.id}>${model.name}</option>`)
                    }
                }
            })
        })

        $("#lastcountries").change(function () {
            let countryId = $(this).val();
            console.log(countryId)
            $("#lastcities").html('')
            //$("#countries").html('')
            //$("#countries").append(`<option value="">Loading...</option>`)
            $.ajax({
                url: `/Address/FindCity?countryId=${countryId}`,
                type: "Get",
                success: function (res) {
                    $("#lastcities").html('')
                    $("#lastcities").append(`<option value="">Seçin</option>`)
                    for (var model of res) {
                        $("#lastcities").append(`<option value=${model.id}>${model.name}</option>`)
                    }
                }
            })
        })
    </script>


@*<script>
        let countryId = "";
        $("#countrySearch").keyup(function () {
            $("#cities").html('')
            $("#citySearch").val("")
            $("#countries").html('')
            $("#countries").append(`<option value="">Loading...</option>`)
            $.ajax({
                url: "/Address/FindCountry",
                data: { Name: $(this).val() },
                type: "Post",
                success: function (res) {
                    var resval = res.value
                    $("#countries").html('')
                    $("#countries").append(`<option value="">Seçin</option>`)
                    for (var model of resval.data) {
                        $("#countries").append(`<option value="${model.wikiDataId + "/" + model.name}">${model.name}</option>`)
                    }
                }
            })
        })


        $("#citySearch").keyup(function () {
            $("#cities").html('')
            $("#cities").append(`<option value="">Loading...</option>`)
            $.ajax({
                url: "/Address/FilterCity",
                data: { Key: $(this).val(), Country: countryId },
                type: "Post",
                success: function (res) {
                    var resval = res.value
                    $("#cities").html('')
                    $("#cities").append(`<option value="">Seçin</option>`)
                    for (var model of resval.data) {
                        $("#cities").append(`<option value="${model.name}">${model.name}</option>`)
                    }
                }
            })
        })

    </script>
    <script>
        let lastcountryId = "";
        $("#lastcountrySearch").keyup(function () {
            $("#lastcities").html('')
            $("#lastcitySearch").val("")
            $("#lastcountries").html('')
            $("#lastcountries").append(`<option value="">Loading...</option>`)
            $.ajax({
                url: "/Address/FindCountry",
                data: { Name: $(this).val() },
                type: "Post",
                success: function (res) {
                    var resval = res.value
                    $("#lastcountries").html('')
                    $("#lastcountries").append(`<option value="">Seçin</option>`)
                    for (var model of resval.data) {
                        $("#lastcountries").append(`<option value="${model.wikiDataId + "/" + model.name}">${model.name}</option>`)
                    }
                }
            })
        })

        $("#lastcountries").change(function () {
            $("#lastcitySearch").val("")
            $("#lastcities").html('')
            $("#lastcities").append(`<option value="">Loading...</option>`)
            lastcountryId = $(this).val().split("/")[0]
            $.ajax({
                url: "/Address/FindCity",
                data: { Country: lastcountryId },
                type: "Post",
                success: function (res) {
                    var resval = res.value
                    $("#lastcities").html('')
                    $("#lastcities").append(`<option value="">Seçin</option>`)
                    for (var model of resval.data) {
                        $("#lastcities").append(`<option value=${model.name}>${model.name}</option>`)
                    }
                }
            })
        })

        $("#lastcitySearch").keyup(function () {
            $("#lastcities").html('')
            $("#lastcities").append(`<option value="">Loading...</option>`)
            $.ajax({
                url: "/Address/FilterCity",
                data: { Key: $(this).val(), Country: lastcountryId },
                type: "Post",
                success: function (res) {
                    var resval = res.value
                    $("#lastcities").html('')
                    $("#lastcities").append(`<option value="">Seçin</option>`)
                    for (var model of resval.data) {
                        $("#lastcities").append(`<option value="${model.name}">${model.name}</option>`)
                    }
                }
            })
        })

    </script>*@
}